; ------------------------------------------------------------------------
;    _       ___      _______     _       ___     __           __
;   | |     / (_)___ /  / __ \   | |     / (_)___/ /___  ___  / /______
;   | | /| / / / __ \/ / / / /   | | /| / / / __  / __ \/ _ \/ __/ ___/
;   | |/ |/ / / / / / / /_/ /    | |/ |/ / / /_/ / /_/ /  __/ /_(__  ) 
;   |__/|__/_/_/ /_/_/\____/     |__/|__/_/\__,_/\__, /\___/\__/____/
;                                               /____/
;
;	Win10 Widgets for Rainmeter - Weather (ExtraLarge)
;		Author  - TJ Markham, http://tjmarkham.com
;		Website - http://win10widgets.com
;		Donate  - http://donate.win10widgets.com
;
; ------------------------------------------------------------------------

; Known bug(s):
; - Sometimes the OnWakeAction is not executed after computer wakes up. 
;	Not sure what the reason behind this is, I suspect it has to do 
;	with the auto-wakeup feature in Windows 10 (used for updates). To fix,
;	simply click the "Refresh" button or refresh the skin.
; - Sometimes the weather data feed goes down. Nothing I can do about 
;	that. If you know of a better source for weather data please let me 
;	know :)

[Rainmeter]
Update=100
; Check internet connectivity when computer wakes up.
OnWakeAction=[!Log "Awake!"][!UpdateMeasure MeasureInternetConnectivity]
; Context menu option to auto-select location based on user's IP.
ContextTitle="Auto-location"
ContextAction=[!WriteKeyValue Variables AutoLocation 1 #CoreFilePath#][!WriteKeyValue Variables FirstStep "MeasureZipCode" #CoreFilePath#][!WriteKeyValue Variables WeatherURL "" #CoreFilePath#][!Refresh]
; Context menu option to change location based on user supplied zip code or city.
ContextTitle2="Set location	(auto: off)"
ContextAction2=[!ShowMeterGroup LocationOverlay][!SetOption MeasureLocationInput DefaultValue "#Location#"][!SetOption LocationInputOverlay Text "#Location#"][!UpdateMeter LocationInputOverlay][!CommandMeasure MeasureLocationInput "ExecuteBatch All"]
; Context menu separator.
ContextTitle3="-"
; Context menu option to change units to imperial units (Fahrenheit, mph, mi, in, etc.).
ContextTitle4="Imperial units (F)"
ContextAction4=[!SetVariable MetricUnits 0][!WriteKeyValue Variables MetricUnits 0 #CoreFilePath#][!UpdateMeasure MeasureUnits]
; Context menu option to change units to metric units (Celsius, km/h, km, mb, etc.).
ContextTitle5="Metric units (C)"
ContextAction5=[!SetVariable MetricUnits 1][!WriteKeyValue Variables MetricUnits 1 #CoreFilePath#][!UpdateMeasure MeasureUnits]
; Context menu separator.
ContextTitle6="-"
; Context menu option to change times to 12-hour format.
ContextTitle7="12-hour time"
ContextAction7=[!SetVariable 24HourTime 0][!WriteKeyValue Variables 24HourTime 0 #CoreFilePath#][!UpdateMeasure MeasureTimeFormat]
; Context menu option to change times to 24-hour format.
ContextTitle8="24-hour time"
ContextAction8=[!SetVariable 24HourTime 1][!WriteKeyValue Variables 24HourTime 1 #CoreFilePath#][!UpdateMeasure MeasureTimeFormat]

[Metadata]
Name=Weather (ExtraLarge)
Author=TJ Markham
Information=Displays the current/future weather based on IP location or user-supplied zip code.
License=Creative Commons BY-NC-SA 4.0
Version=1.0.0

[Variables]
@Include1=#@#systemColors.ini
@Include2=#@#variables.ini
@Include3=#@#styles.ini
@Include4=#@#background.ini
CoreFilePath=""#CURRENTPATH#Weather-ExtraLarge.ini""
BackgroundHeight=212
AutoBorder=1
WOEIDurlPart1="https://query.yahooapis.com/v1/public/yql?q=select%20woeid%20from%20geo.places(1)%20where%20text%3D%22"
WOEIDurlPart2="%22"
WOEIDurl=""
WeatherURLpart1Zip="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%20in%20(select%20woeid%20from%20geo.places(1)%20where%20text%3D%22"
WeatherURLpart2Zip="%22)&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback="
WeatherURLpart1WOEID="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%20%3D%20"
WeatherURLpart2WOEID="&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback="
WeatherURL=
AutoLocation=1
FirstStep=MeasureZipCode
UpdateRate=16425
Location=""
WindDirection=360
MetricUnits=0
24HourTime=0
UnitTemp="F"
UnitSpeed="mph"
UnitDistance="mi"
UnitPressure="in"


; ------------------------------------------------------------------------
; MEASURES
; ------------------------------------------------------------------------

[MeasureUnits]
; Sets units depending on status of #MetricUnits# (which is controlled by context menu options).
Measure=Calc
; 0: Imperial Units, 1: Metric Units
IfCondition=(#MetricUnits#=0)
IfTrueAction=[!SetVariable UnitTemp "F"][!SetOption MeterTemp MeasureName MeasureTempF][!SetOption MeterFeelsLike MeasureName MeasureTempF][!SetOption MeterDay1High MeasureName MeasureDay1HighF][!SetOption MeterDay1Low MeasureName MeasureDay1LowF][!SetOption MeterDay2High MeasureName MeasureDay2HighF][!SetOption MeterDay2Low MeasureName MeasureDay2LowF][!SetOption MeterDay3High MeasureName MeasureDay3HighF][!SetOption MeterDay3Low MeasureName MeasureDay3LowF][!SetOption MeterDay4High MeasureName MeasureDay4HighF][!SetOption MeterDay4Low MeasureName MeasureDay4LowF][!SetOption MeterDay5High MeasureName MeasureDay5HighF][!SetOption MeterDay5Low MeasureName MeasureDay5LowF][!SetVariable UnitSpeed "mph"][!SetOption MeterWind MeasureName MeasureWindSpeedMPH][!SetVariable UnitDistance "mi"][!SetOption MeterVisibility MeasureName MeasureVisibilityMI][!SetVariable UnitPressure "in"][!SetOption MeterBarometer MeasureName MeasureBarometerIN][!UpdateMeterGroup UnitMeters]
IfFalseAction=[!SetVariable UnitTemp "C"][!SetOption MeterTemp MeasureName MeasureTempC][!SetOption MeterFeelsLike MeasureName MeasureTempC][!SetOption MeterDay1High MeasureName MeasureDay1HighC][!SetOption MeterDay1Low MeasureName MeasureDay1LowC][!SetOption MeterDay2High MeasureName MeasureDay2HighC][!SetOption MeterDay2Low MeasureName MeasureDay2LowC][!SetOption MeterDay3High MeasureName MeasureDay3HighC][!SetOption MeterDay3Low MeasureName MeasureDay3LowC][!SetOption MeterDay4High MeasureName MeasureDay4HighC][!SetOption MeterDay4Low MeasureName MeasureDay4LowC][!SetOption MeterDay5High MeasureName MeasureDay5HighC][!SetOption MeterDay5Low MeasureName MeasureDay5LowC][!SetVariable UnitSpeed "km/h"][!SetOption MeterWind MeasureName MeasureWindSpeedKPH][!SetVariable UnitDistance "km"][!SetOption MeterVisibility MeasureName MeasureVisibilityKM][!SetVariable UnitPressure "mb"][!SetOption MeterBarometer MeasureName MeasureBarometerMB][!UpdateMeterGroup UnitMeters]
DynamicVariables=1
UpdateDivider=-1

[MeasureTimeFormat]
; Sets 12-hr or 24-hr time format depending on #24Hourtime# (which is controlled by context menu options).
Measure=Calc
; 0: 12-hr time format, 1: 24-hr time format
IfCondition=(#24HourTime#=0)
IfTrueAction=[!SetOption MeasureTime Format "%#I:%M %p"][!UpdateMeasure MeasureTime][!UpdateMeter MeterLocation][!SetOption MeterSunrise MeasureName MeasureSunrise12][!UpdateMeter MeterSunrise][!SetOption MeterSunset MeasureName MeasureSunset12][!UpdateMeter MeterSunset]
IfFalseAction=[!SetOption MeasureTime Format "%#H:%M"][!UpdateMeasure MeasureTime][!UpdateMeter MeterLocation][!SetOption MeterSunrise MeasureName MeasureSunrise24][!UpdateMeter MeterSunrise][!SetOption MeterSunset MeasureName MeasureSunset24][!UpdateMeter MeterSunset]
DynamicVariables=1
UpdateDivider=-1

[MeasureAutoLocation]
; Changes data flow depending on whether auto-location is turned on or not.
Measure=Calc
; 0: Auto-location off, 1: Auto-location on
IfCondition=(#AutoLocation#=0)
IfTrueAction=[!DisableMeasure MeasureZipCode][!SetOption MeasureWeather UpdateDivider #UpdateRate#]
IfFalseAction=[!EnableMeasure MeasureZipCode]
UpdateDivider=-1

[MeasureInternetConnectivity]
; Returns the status of the internet connection.
; Changes error text depending on situation.
Measure=Plugin
Plugin=SysInfo
SysInfoType=INTERNET_CONNECTIVITY
; -1: No Internet, 1: Connected
IfCondition=(MeasureInternetConnectivity=-1)
;IfTrueAction=[!Log "Lost Internet..."]
IfTrueAction=[!SetOption PreButtonText2 Text "Connect to internet and try again."]
;IfFalseAction=[!Log "Found Internet..."]
IfFalseAction=[!SetOption PreButtonText2 Text "Try again in a couple seconds."][!UpdateMeasure #FirstStep#]
;[!CommandMeasure #FirstStep# Update]

[MeasureZipCode]
; Returns Zip Code of current location (not the *most* accurate, but it's not bad).
; Success action: Sets WeatherURL for future use and initiates MeasureWeather.
; Failure action: Shows RefreshOverlay
Measure=Plugin
Plugin=WebParser.dll
URL=http://ipinfo.io/postal
;URL=file://#CURRENTPATH#test-zip.txt
RegExp=\d+
;OnUpdateAction=[!Log "Retrieving Zip Code..."]
;FinishAction=[!Log "Retrieved Zip Code."]
FinishAction=[!SetOption RefreshButton MouseLeaveAction "[]"][!UpdateMeter RefreshButton][!HideMeterGroup RefreshOverlay][!SetVariable WeatherURL "#WeatherURLpart1Zip#[MeasureZipCode]#WeatherURLpart2Zip#"][!UpdateMeasure MeasureWeather]
OnConnectErrorAction=[!HideMeterGroup WeatherMeters][!ShowMeter RetrievingWeather][!SetOption RefreshButton MouseLeaveAction "[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]"][!UpdateMeter RefreshButton][!ShowMeterGroup RefreshOverlay][!HideMeter RefreshButtonHoverEdge]
OnRegExpErrorAction=[!HideMeterGroup WeatherMeters][!ShowMeter RetrievingWeather][!SetOption RefreshButton MouseLeaveAction "[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]"][!UpdateMeter RefreshButton][!ShowMeterGroup RefreshOverlay][!HideMeter RefreshButtonHoverEdge]
UpdateDivider=#UpdateRate#
UpdateRate=1

[MeasureLocationWOEID]
; Checks to see if user-provided location is valid (i.e. has a corresponding WOEID). If location is valid, turns off auto-location and sets the WeatherURL.
Measure=Plugin
Plugin=WebParser.dll
URL=#WOEIDurl#
;URL=file://#CURRENTPATH#test-woeid.txt
RegExp="<woeid>(.*)</woeid>"
RegExpSubstitute=1
Substitute="<woeid>(.*)</woeid>":"\1"
;OnUpdateAction=[!Log "Testing WOEID..."]
;FinishAction=[!Log "Good WOEID."]
FinishAction=[!WriteKeyValue Variables AutoLocation 0 #CoreFilePath#][!WriteKeyValue Variables FirstStep "MeasureWeather" #CoreFilePath#][!WriteKeyValue Variables WeatherURL "#WeatherURLpart1WOEID#[MeasureLocationWOEID]#WeatherURLpart2WOEID#" #CoreFilePath#][!Refresh]
OnConnectErrorAction=[!HideMeterGroup WeatherMeters][!ShowMeter RetrievingWeather][!SetOption RefreshButton MouseLeaveAction "[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]"][!UpdateMeter RefreshButton][!ShowMeterGroup RefreshOverlay][!HideMeter RefreshButtonHoverEdge]
;OnRegExpErrorAction=[!Log "Bad WOEID."]
OnRegExpErrorAction=[!HideMeter CheckingLocationText][!ShowMeter ErrorText]
DynamicVariables=1
UpdateDivider=-1
UpdateRate=1

[MeasureWeather]
; Returns current conditions and 5-day forecast.
Measure=Plugin
Plugin=WebParser.dll
URL=#WeatherURL#
;URL=file://#CURRENTPATH#test-Weather.txt
RegExp=(?siU)temperature":"(.*)".*lastBuildDate":"(.*)".*city":"(.*)".*region":"(.*)".*chill":"(.*)".*direction":"(.*)".*speed":"(.*)".*humidity":"(.*)".*pressure":"(.*)".*visibility":"(.*)".*sunrise":"(.*)".*sunset":"(.*)".*code":"(.*)".*temp":"(.*)".*text":"(.*)".*forecast.*code":"(.*)".*day":"(.*)".*high":"(.*)".*low":"(.*)".*code":"(.*)".*day":"(.*)".*high":"(.*)".*low":"(.*)".*code":"(.*)".*day":"(.*)".*high":"(.*)".*low":"(.*)".*code":"(.*)".*day":"(.*)".*high":"(.*)".*low":"(.*)".*code":"(.*)".*day":"(.*)".*high":"(.*)".*low":"(.*)"
OnUpdateAction=[!Log "Retrieving weather..."]
FinishAction=[!Log "Retrieved weather."][!SetOption RefreshButton MouseLeaveAction "[]"][!UpdateMeter RefreshButton][!HideMeterGroup RefreshOverlay][!UpdateMeasureGroup WeatherMeasures][!ShowMeterGroup WeatherMeters][!UpdateMeterGroup WeatherMeters][!HideMeter RetrievingWeather]
OnConnectErrorAction=[!HideMeterGroup WeatherMeters][!ShowMeter RetrievingWeather][!SetOption RefreshButton MouseLeaveAction "[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]"][!UpdateMeter RefreshButton][!ShowMeterGroup RefreshOverlay][!HideMeter RefreshButtonHoverEdge]
OnRegExpErrorAction=[!HideMeterGroup WeatherMeters][!ShowMeter RetrievingWeather][!SetOption RefreshButton MouseLeaveAction "[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]"][!UpdateMeter RefreshButton][!ShowMeterGroup RefreshOverlay][!HideMeter RefreshButtonHoverEdge]
DynamicVariables=1
UpdateDivider=-1
UpdateRate=1

[MeasureTime]
; Returns time in 12-hour format (omitting first 0 of hour).
Measure=Time
Format=%#I:%M %p
OnChangeAction=[!UpdateMeter MeterUpdatedTime]
Group=WeatherMeasures
UpdateDivider=-1

;[MeasureUpdatedTime]
;Measure=Plugin
;Plugin=WebParser.dll
;URL=[MeasureWeather]
;StringIndex=2
;RegExp=\d{1,2}:\d{2} (AM|PM)
;RegExpSubstitute=1
;Substitute="0(\d{1}):":"\1:"
;OnChangeAction=[!UpdateMeter MeterUpdatedTime]
;Group=WeatherMeasures
;UpdateDivider=-1

;[MeasureUpdatedDate]
;Measure=Plugin
;Plugin=WebParser.dll
;URL=[MeasureWeather]
;StringIndex=2
;RegExp=\d+ \D+ \d+
;RegExpSubstitute=1
;Substitute="(\d+) (\D+) (\d+)":"\2 \1, \3"
;OnChangeAction=[!UpdateMeter MeterUpdatedTime]
;Group=WeatherMeasures
;UpdateDivider=-1

[MeasureCity]
; Returns city.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=3
OnChangeAction=[!UpdateMeter MeterLocation][!SetVariable Location "[MeasureCity],[MeasureRegion]"][!UpdateMeter LocationInputOverlay]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureRegion]
; Returns region (State if you're in the US).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=4
OnChangeAction=[!UpdateMeter MeterLocation][!SetVariable Location "[MeasureCity],[MeasureRegion]"][!UpdateMeter LocationInputOverlay]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureFeelsLike]
; Returns "feels like" temperature (current temperature minus wind chill).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=5
OnChangeAction=[!UpdateMeasure MeasureFeelsLikeF][!UpdateMeasure MeasureFeelsLikeC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureFeelsLikeF]
; Returns "feels like" temperature in Fahrenheit
Measure=Calc
Formula=Round(MeasureFeelsLike,0)
OnChangeAction=[!UpdateMeter MeterFeelsLike]
UpdateDivider=-1

[MeasureFeelsLikeC]
; Returns "feels like" temperature in Celsius.
Measure=Calc
Formula=Round(((MeasureFeelsLike-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterFeelsLike]
UpdateDivider=-1

[MeasureWindDirection]
; Returns direction (1-360 degrees) of where wind is blowing from.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=6
Substitute="":"0"
OnChangeAction=[!SetVariable WindDirection [MeasureWindDirection]][!UpdateMeter MeterWindDirection]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureWindSpeed]
; Returns wind speed.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=7
OnChangeAction=[!UpdateMeasure MeasureWindSpeedKPH][!UpdateMeasure MeasureWindSpeedMPH]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureWindSpeedKPH]
; Returns wind speed in kilometers/hour.
Measure=Calc
Formula=Round(MeasureWindSpeed,0)
OnChangeAction=[!UpdateMeter MeterWind]
UpdateDivider=-1

[MeasureWindSpeedMPH]
; Returns wind speed in miles/hour.
Measure=Calc
Formula=Round((MeasureWindSpeed*#KMtoMIconversionFactor#),0)
OnChangeAction=[!UpdateMeter MeterWind]
UpdateDivider=-1

[MeasureHumidity]
; Returns humidity.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=8
OnChangeAction=[!UpdateMeter MeterHumidity]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureVisibility]
; Returns visibility.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=10
OnChangeAction=[!UpdateMeasure MeasureVisibilityKM][!UpdateMeasure MeasureVisibilityMI]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureVisibilityKM]
; Returns visibility in kilometers.
Measure=Calc
Formula=Round(MeasureVisibility,0)
OnChangeAction=[!UpdateMeter MeterVisibility]
UpdateDivider=-1

[MeasureVisibilityMI]
; Returns visibility in miles.
Measure=Calc
Formula=Round((MeasureVisibility*#KMtoMIconversionFactor#),0)
OnChangeAction=[!UpdateMeter MeterVisibility]
UpdateDivider=-1

[MeasureBarometer]
; Returns barometer reading (pressure).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=9
OnChangeAction=[!UpdateMeasure MeasureBarometerMB][!UpdateMeasure MeasureBarometerIN]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureBarometerMB]
; Returns barometer reading (pressure) in millibars.
Measure=Calc
Formula=Round(MeasureBarometer,2)
OnChangeAction=[!UpdateMeter MeterBarometer]
UpdateDivider=-1

[MeasureBarometerIN]
; Returns barometer reading (pressure) in inches of mercury.
Measure=Calc
Formula=Round((MeasureBarometerMB*#MBtoINconversionFactor#),2)
OnChangeAction=[!UpdateMeter MeterBarometer]
UpdateDivider=-1

[MeasureSunrise12]
; Returns time of sunrise in 12-hr time format.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=11
RegExpSubstitute=1
Substitute=":(\d{1}) ":":0\1 ","am":"AM","pm":"PM"
OnChangeAction=[!UpdateMeasure MeasureSunriseHour][!UpdateMeasure MeasureSunriseMinute][!UpdateMeasure MeasureSunriseAMPM][!UpdateMeter MeterSunrise]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureSunriseHour]
; Returns hour of sunrise in 12-hr time format.
Measure=String
String=[MeasureSunrise12]
RegExpSubstitute=1
Substitute="(\d{1,2}):.*":"\1"
OnChangeAction=[!UpdateMeasure MeasureSunriseHour24][!UpdateMeasure MeasureSunrise24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunriseMinute]
; Returns minute of sunrise.
Measure=String
String=[MeasureSunrise12]
RegExpSubstitute=1
Substitute="\d{1,2}(:\d{2}).*":"\1"
OnChangeAction=[!UpdateMeasure MeasureSunrise24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunriseAMPM]
; Returns AM/PM status of sunrise.
Measure=String
String=[MeasureSunrise12]
RegExpSubstitute=1
Substitute="\d{1,2}:\d{2} (.*)":"\1","AM":"0","PM":"1","":"0"
OnChangeAction=[!UpdateMeasure MeasureSunriseHour24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunriseHour24]
; Returns hour of sunrise in 24-hr time format.
Measure=Calc
Formula=([MeasureSunriseAMPM] = 0 ? MeasureSunriseHour : (MeasureSunriseHour+12))
OnChangeAction=[!UpdateMeasure MeasureSunrise24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunrise24]
; Returns time of sunrise in 24-hr time format.
Measure=String
String=[MeasureSunriseHour24][MeasureSunriseMinute]
OnChangeAction=[!UpdateMeter MeterSunrise]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunset12]
; Returns time of sunset in 12-hr time format.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=12
RegExpSubstitute=1
Substitute=":(\d{1}) ":":0\1 ","am":"AM","pm":"PM"
OnChangeAction=[!UpdateMeasure MeasureSunsetHour][!UpdateMeasure MeasureSunsetMinute][!UpdateMeasure MeasureSunsetAMPM][!UpdateMeter MeterSunset]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureSunsetHour]
; Returns hour of sunset in 12-hr time format.
Measure=String
String=[MeasureSunset12]
RegExpSubstitute=1
Substitute="(\d{1,2}):.*":"\1"
OnChangeAction=[!UpdateMeasure MeasureSunsetHour24][!UpdateMeasure MeasureSunset24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunsetMinute]
; Returns minute of sunset.
Measure=String
String=[MeasureSunset12]
RegExpSubstitute=1
Substitute="\d{1,2}(:\d{2}).*":"\1"
OnChangeAction=[!UpdateMeasure MeasureSunset24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunsetAMPM]
; Returns AM/PM status of sunset.
Measure=String
String=[MeasureSunset12]
RegExpSubstitute=1
Substitute="\d{1,2}:\d{2} (.*)":"\1","AM":"0","PM":"1","":"0"
OnChangeAction=[!UpdateMeasure MeasureSunsetHour24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunsetHour24]
; Returns hour of sunset in 24-hr time format.
Measure=Calc
Formula=([MeasureSunsetAMPM] = 0 ? MeasureSunsetHour : (MeasureSunsetHour+12))
OnChangeAction=[!UpdateMeasure MeasureSunset24]
DynamicVariables=1
UpdateDivider=-1

[MeasureSunset24]
; Returns time of sunset in 24-hr time format.
Measure=String
String=[MeasureSunsetHour24][MeasureSunsetMinute]
OnChangeAction=[!UpdateMeter MeterSunset]
DynamicVariables=1
UpdateDivider=-1

[MeasureForecastText]
; Returns text reflecting the current condition (e.g. "Mostly Sunny").
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=15
OnChangeAction=[!UpdateMeter MeterForecastText]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureImageCode]
; Returns icon code for the image of the current condition.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=13
Substitute="":"3200"
OnChangeAction=[!UpdateMeter MeterForecastImage]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureTemp]
; Returns current temperature.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=14
OnChangeAction=[!UpdateMeasure MeasureTempF][!UpdateMeasure MeasureTempC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureTempF]
; Returns current temperature in Fahrenheit.
Measure=Calc
Formula=Round(MeasureTemp,0)
OnChangeAction=[!UpdateMeter MeterTemp]
UpdateDivider=-1

[MeasureTempC]
; Returns current temperature in Celsius.
Measure=Calc
Formula=Round(((MeasureTemp-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterTemp]
UpdateDivider=-1

[MeasureDay1]
; Returns abbreviated name of day 1 (e.g. Mon).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=17
OnChangeAction=[!UpdateMeter MeterDay1]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay1Low]
; Returns forecasted low temperature for day 1.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=19
OnChangeAction=[!UpdateMeasure MeasureDay1LowF][!UpdateMeasure MeasureDay1LowC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay1LowF]
; Returns forecasted low temperature for day 1 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay1Low,0)
OnChangeAction=[!UpdateMeter MeterDay1Low]
UpdateDivider=-1

[MeasureDay1LowC]
; Returns forecasted low temperature for day 1 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay1Low-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay1Low]
UpdateDivider=-1

[MeasureDay1High]
; Returns forecasted high temperature for day 1.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=18
OnChangeAction=[!UpdateMeasure MeasureDay1HighF][!UpdateMeasure MeasureDay1HighC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay1HighF]
; Returns forecasted high temperature for day 1 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay1High,0)
OnChangeAction=[!UpdateMeter MeterDay1High]
UpdateDivider=-1

[MeasureDay1HighC]
; Returns forecasted high temperature for day 1 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay1High-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay1High]
UpdateDivider=-1

[MeasureDay1Code]
; Returns icon code for the image of the forecasted condition for day 1.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=16
Substitute="":"3200"
OnChangeAction=[!UpdateMeter MeterDay1Image]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay2]
; Returns abbreviated name of day 2 (e.g. Tue).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=21
OnChangeAction=[!UpdateMeter MeterDay2]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay2Low]
; Returns forecasted low temperature for day 2.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=23
OnChangeAction=[!UpdateMeasure MeasureDay2LowF][!UpdateMeasure MeasureDay2LowC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay2LowF]
; Returns forecasted low temperature for day 2 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay2Low,0)
OnChangeAction=[!UpdateMeter MeterDay2Low]
UpdateDivider=-1

[MeasureDay2LowC]
; Returns forecasted low temperature for day 2 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay2Low-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay2Low]
UpdateDivider=-1

[MeasureDay2High]
; Returns forecasted high temperature for day 2.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=22
OnChangeAction=[!UpdateMeasure MeasureDay2HighF][!UpdateMeasure MeasureDay2HighC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay2HighF]
; Returns forecasted high temperature for day 2 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay2High,0)
OnChangeAction=[!UpdateMeter MeterDay2High]
UpdateDivider=-1

[MeasureDay2HighC]
; Returns forecasted high temperature for day 2 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay2High-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay2High]
UpdateDivider=-1

[MeasureDay2Code]
; Returns icon code for the image of the forecasted condition for day 2.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=20
Substitute="":"3200"
OnChangeAction=[!UpdateMeter MeterDay2Image]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay3]
; Returns abbreviated name of day 3 (e.g. Wed).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=25
OnChangeAction=[!UpdateMeter MeterDay3]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay3Low]
; Returns forecasted low temperature for day 3.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=27
OnChangeAction=[!UpdateMeasure MeasureDay3LowF][!UpdateMeasure MeasureDay3LowC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay3LowF]
; Returns forecasted low temperature for day 3 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay3Low,0)
OnChangeAction=[!UpdateMeter MeterDay3Low]
UpdateDivider=-1

[MeasureDay3LowC]
; Returns forecasted low temperature for day 3 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay3Low-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay3Low]
UpdateDivider=-1

[MeasureDay3High]
; Returns forecasted high temperature for day 3.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=26
OnChangeAction=[!UpdateMeasure MeasureDay3HighF][!UpdateMeasure MeasureDay3HighC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay3HighF]
; Returns forecasted high temperature for day 3 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay3High,0)
OnChangeAction=[!UpdateMeter MeterDay3High]
UpdateDivider=-1

[MeasureDay3HighC]
; Returns forecasted high temperature for day 3 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay3High-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay3High]
UpdateDivider=-1

[MeasureDay3Code]
; Returns icon code for the image of the forecasted condition for day 3.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=24
Substitute="":"3200"
OnChangeAction=[!UpdateMeter MeterDay3Image]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay4]
; Returns abbreviated name of day 4 (e.g. Thu).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=29
OnChangeAction=[!UpdateMeter MeterDay4]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay4Low]
; Returns forecasted low temperature for day 4.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=31
OnChangeAction=[!UpdateMeasure MeasureDay4LowF][!UpdateMeasure MeasureDay4LowC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay4LowF]
; Returns forecasted low temperature for day 4 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay4Low,0)
OnChangeAction=[!UpdateMeter MeterDay4Low]
UpdateDivider=-1

[MeasureDay4LowC]
; Returns forecasted low temperature for day 4 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay4Low-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay4Low]
UpdateDivider=-1

[MeasureDay4High]
; Returns forecasted high temperature for day 4.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=30
OnChangeAction=[!UpdateMeasure MeasureDay4HighF][!UpdateMeasure MeasureDay4HighC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay4HighF]
; Returns forecasted high temperature for day 4 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay4High,0)
OnChangeAction=[!UpdateMeter MeterDay4High]
UpdateDivider=-1

[MeasureDay4HighC]
; Returns forecasted high temperature for day 4 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay4High-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay4High]
UpdateDivider=-1

[MeasureDay4Code]
; Returns icon code for the image of the forecasted condition for day 4.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=28
Substitute="":"3200"
OnChangeAction=[!UpdateMeter MeterDay4Image]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay5]
; Returns abbreviated name of day 5 (e.g. Fri).
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=33
OnChangeAction=[!UpdateMeter MeterDay5]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay5Low]
; Returns forecasted low temperature for day 5.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=35
OnChangeAction=[!UpdateMeasure MeasureDay5LowF][!UpdateMeasure MeasureDay5LowC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay5LowF]
; Returns forecasted low temperature for day 5 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay5Low,0)
OnChangeAction=[!UpdateMeter MeterDay5Low]
UpdateDivider=-1

[MeasureDay5LowC]
; Returns forecasted low temperature for day 5 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay5Low-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay5Low]
UpdateDivider=-1

[MeasureDay5High]
; Returns forecasted high temperature for day 5.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=34
OnChangeAction=[!UpdateMeasure MeasureDay5HighF][!UpdateMeasure MeasureDay5HighC]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureDay5HighF]
; Returns forecasted high temperature for day 5 in Fahrenheit.
Measure=Calc
Formula=Round(MeasureDay5High,0)
OnChangeAction=[!UpdateMeter MeterDay5High]
UpdateDivider=-1

[MeasureDay5HighC]
; Returns forecasted high temperature for day 5 in Celsius.
Measure=Calc
Formula=Round(((MeasureDay5High-32)*(5/9)),0)
OnChangeAction=[!UpdateMeter MeterDay5High]
UpdateDivider=-1

[MeasureDay5Code]
; Returns icon code for the image of the forecasted condition for day 5.
Measure=Plugin
Plugin=WebParser.dll
URL=[MeasureWeather]
StringIndex=32
Substitute="":"3200"
OnChangeAction=[!UpdateMeter MeterDay5Image]
Group=WeatherMeasures
UpdateDivider=-1

[MeasureLocationInput]
; Accepts user input for location and initiates the location confirmation process when input is confirmed (i.e. when "enter" is pressed). 
Measure=Plugin
Plugin=InputText
Command1=[!HideMeter LocationInputBorder][!SetOption MeasureLocationInput DefaultValue "$UserInput$"][!SetOption LocationInputOverlay Text "[MeasureLocationInput]"][!UpdateMeter LocationInputOverlay][!SetVariable WOEIDurl "#WOEIDurlPart1#[MeasureLocationInput]#WOEIDurlPart2#"][!HideMeter ErrorText][!ShowMeter CheckingLocationText][!UpdateMeasure MeasureLocationWOEID]
DefaultValue=#Location#
X=([LocationInputOverlayBorder:X]+2)
Y=([LocationInputOverlayBorder:Y]+2)
W=([LocationInputOverlayBorder:W]-4)
H=([LocationInputOverlayBorder:H]-4)
SolidColor=#SolidWhite#
FontColor=#SolidBlack#
FontFace=Segoe UI
FontSize=11
StringAlign=Left
OnDismissAction=[!HideMeter LocationInputBorder]
AntiAlias=1
DynamicVariables=1
UpdateDivider=-1


; ------------------------------------------------------------------------
; METERS
; ------------------------------------------------------------------------

[RetrievingWeather]
; Shows "Retrieving Weather...".
Meter=String
MeterStyle=StyleMediumText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=85
Text="Retrieving Weather..."
UpdateDivider=-1


; ------------------------------------------------------------------------
; METERS - Current Conditions
; ------------------------------------------------------------------------

[MeterForecastImage]
; Shows image reflecting the current condition.
Meter=Image
X=16
Y=21
W=54
H=54
ImageName="icons\[MeasureImageCode].png"
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterForecastText]
; Shows text reflecting the current condition (e.g. "Mostly Sunny").
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText
MeasureName=MeasureForecastText
X=11R
Y=-8r
Group=WeatherMeters
Text="%1"
ClipString=2
;ClipStringW=121
ClipStringW=125
UpdateDivider=-1
DynamicVariables=1
Hidden=1

[MeterTemp]
; Shows current temperature.
Meter=String
MeterStyle=StyleBigText
MeasureName=MeasureTempF
X=-6r
Y=15r
Group=WeatherMeters | UnitMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterTempUnit]
; Shows temperature unit (°C or °F).
Meter=String
MeterStyle=StyleBigText
X=-9R
Y=0r
Group=WeatherMeters | UnitMeters
Text="°#UnitTemp#"
DynamicVariables=1
UpdateDivider=-1
Hidden=1


; ------------------------------------------------------------------------
; METERS - Forecast
; ------------------------------------------------------------------------

[MeterDay1Image]
; Shows image of the forecasted condition for day 1.
Meter=Image
ImageName="icons\[MeasureDay1Code].png"
X=16
Y=121
W=30
H=30
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterDay1]
; Shows abbreviated name of day 1 (e.g. Mon).
Meter=String
MeasureName=MeasureDay1
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
X=14r
Y=-24r
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterDay1High]
; Shows forecasted high temperature for day 1.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
MeasureName=MeasureDay1HighF
X=0r
Y=45R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay1Low]
; Shows forecasted low temperature for day 1.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureDay1LowF
X=0r
Y=-1R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay2Image]
; Shows image of the forecasted condition for day 2.
Meter=Image
ImageName="icons\[MeasureDay2Code].png"
X=([MeterDay1Image:X]+[MeterDay1Image:W]+9)
Y=[MeterDay1Image:Y]
W=30
H=30
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterDay2]
; Shows abbreviated name of day 2 (e.g. Tue).
Meter=String
MeasureName=MeasureDay2
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
X=14r
Y=-24r
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterDay2High]
; Shows forecasted high temperature for day 2.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
MeasureName=MeasureDay2HighF
X=0r
Y=45R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay2Low]
; Shows forecasted low temperature for day 2.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureDay2LowF
X=0r
Y=-1R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay3Image]
; Shows image of the forecasted condition for day 3.
Meter=Image
ImageName="icons\[MeasureDay3Code].png"
X=([MeterDay2Image:X]+[MeterDay2Image:W]+9)
Y=[MeterDay2Image:Y]
W=30
H=30
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterDay3]
; Shows abbreviated name of day 3 (e.g. Wed).
Meter=String
MeasureName=MeasureDay3
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
X=14r
Y=-24r
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterDay3High]
; Shows forecasted high temperature for day 3.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
MeasureName=MeasureDay3HighF
X=0r
Y=45R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay3Low]
; Shows forecasted low temperature for day 3.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureDay3LowF
X=0r
Y=-1R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay4Image]
; Shows image of the forecasted condition for day 4.
Meter=Image
ImageName="icons\[MeasureDay4Code].png"
X=([MeterDay3Image:X]+[MeterDay3Image:W]+9)
Y=[MeterDay3Image:Y]
W=30
H=30
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterDay4]
; Shows abbreviated name of day 4 (e.g. Thu).
Meter=String
MeasureName=MeasureDay4
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
X=14r
Y=-24r
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterDay4High]
; Shows forecasted high temperature for day 4.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
MeasureName=MeasureDay4HighF
X=0r
Y=45R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay4Low]
; Shows forecasted low temperature for day 4.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureDay4LowF
X=0r
Y=-1R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay5Image]
; Shows image of the forecasted condition for day 5.
Meter=Image
ImageName="icons\[MeasureDay5Code].png"
X=([MeterDay4Image:X]+[MeterDay4Image:W]+9)
Y=[MeterDay4Image:Y]
W=30
H=30
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterDay5]
; Shows abbreviated name of day 5 (e.g. Fri).
Meter=String
MeasureName=MeasureDay5
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
X=14r
Y=-24r
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterDay5High]
; Shows forecasted high temperature for day 5.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText | StyleCenterAlign
MeasureName=MeasureDay5HighF
X=0r
Y=45R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1

[MeterDay5Low]
; Shows forecasted low temperature for day 5.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureDay5LowF
X=0r
Y=-1R
Group=WeatherMeters | UnitMeters
Text="%1°"
UpdateDivider=-1
Hidden=1


; ------------------------------------------------------------------------
; METERS - Side Labels
; ------------------------------------------------------------------------

[FeelsLikeLabel]
; Shows "Feels Like".
Meter=String
MeterStyle=StyleTinyText
X=220
Y=14
Group=WeatherMeters
Text="Feels Like"
UpdateDivider=-1
Hidden=1

[WindLabel]
; Shows "Wind".
Meter=String
MeterStyle=StyleTinyText
X=0r
Y=0R
Group=WeatherMeters
Text="Wind"
UpdateDivider=-1
Hidden=1

[VisibilityLabel]
; Shows "Visibility".
Meter=String
MeterStyle=StyleTinyText
X=0r
Y=0R
Group=WeatherMeters
Text="Visibility"
UpdateDivider=-1
Hidden=1

[BarometerLabel]
; Shows "Barometer".
Meter=String
MeterStyle=StyleTinyText
X=0r
Y=0R
Group=WeatherMeters
Text="Barometer"
UpdateDivider=-1
Hidden=1

[HumidityLabel]
; Shows "Humidity".
Meter=String
MeterStyle=StyleTinyText
X=0r
Y=0R
Group=WeatherMeters
Text="Humidity"
UpdateDivider=-1
Hidden=1

[SunriseLabel]
; Shows "Sunrise".
Meter=String
MeterStyle=StyleTinyText
X=0r
Y=15R
Group=WeatherMeters
Text="Sunrise"
UpdateDivider=-1
Hidden=1

[SunsetLabel]
; Shows "Sunset".
Meter=String
MeterStyle=StyleTinyText
X=0r
Y=0R
Group=WeatherMeters
Text="Sunset"
UpdateDivider=-1
Hidden=1

[MeterUpdatedTime]
; Shows last time weather data was updated.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureTime
X=279
Y=15R
Group=WeatherMeters
Text="Updated at %1"
UpdateDivider=-1
Hidden=1

[MeterLocation]
; Shows the location corresponding to the current weather forecast.
Meter=String
MeterStyle=StyleTinyText | StyleCenterAlign
MeasureName=MeasureCity
MeasureName2=MeasureRegion
X=279
Y=1R
H=18
Group=WeatherMeters
Text="%1,%2"
ClipString=2
ClipStringW=119
UpdateDivider=-1
Hidden=1


; ------------------------------------------------------------------------
; METERS - Side Values
; ------------------------------------------------------------------------

[MeterFeelsLike]
; Shows "feels like" temperature (current temperature minus wind chill).
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureFeelsLikeF
X=([FeelsLikeLabel:X]+65)
Y=[FeelsLikeLabel:Y]
Group=WeatherMeters | UnitMeters
Text="%1 °#UnitTemp#"
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterWindDirection]
; Arrow icon shows direction wind is blowing.
Meter=Image
ImageName="icons\WindDirection.png"
X=0r
Y=2R
W=12
H=12
AntiAlias=1
Group=WeatherMeters
DynamicVariables=1
TransformationMatrix=(Cos(Rad(#WindDirection#)));(Sin(Rad(#WindDirection#)));(-Sin(Rad(#WindDirection#)));(Cos(Rad(#WindDirection#)));(([MeterWindDirection:X]+0.5*[MeterWindDirection:W])-([MeterWindDirection:X]+0.5*[MeterWindDirection:W])*Cos(Rad(#WindDirection#))+([MeterWindDirection:Y]+0.5*[MeterWindDirection:H])*Sin(Rad(#WindDirection#)));(([MeterWindDirection:Y]+0.5*[MeterWindDirection:H])-([MeterWindDirection:X]+0.5*[MeterWindDirection:W])*Sin(Rad(#WindDirection#))-([MeterWindDirection:Y]+0.5*[MeterWindDirection:H])*Cos(Rad(#WindDirection#)))
UpdateDivider=-1
Hidden=1

[MeterWind]
; Shows wind speed.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureWindSpeedMPH
X=12r
Y=-2r
Group=WeatherMeters | UnitMeters
Text="%1 #UnitSpeed#"
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterVisibility]
; Shows visibility distance.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureVisibilityMI
X=[MeterFeelsLike:X]
Y=0R
Group=WeatherMeters | UnitMeters
Text="%1 #UnitDistance#"
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterBarometer]
; Shows barometer (i.e. pressure) reading.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureBarometerIN
X=0r
Y=0R
Group=WeatherMeters | UnitMeters
Text="%1 #UnitPressure#"
NumOfDecimals=2
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[MeterHumidity]
; Shows humidity.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureHumidity
X=0r
Y=0R
Group=WeatherMeters
Text="%1 %"
UpdateDivider=-1
Hidden=1

[MeterSunrise]
; Shows time of sunrise.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureSunrise12
X=0r
Y=15R
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1

[MeterSunset]
; Shows time of sunset.
Meter=String
MeterStyle=StyleTinyText | StyleWhiteText
MeasureName=MeasureSunset12
X=0r
Y=0R
Group=WeatherMeters
Text="%1"
UpdateDivider=-1
Hidden=1


; ------------------------------------------------------------------------
; METERS - Refresh overlay
; ------------------------------------------------------------------------

[RefreshBackground]
; Shows background of overlay.
Meter=Image
X=1
Y=1
W=(#BackgroundWidth#-2)
H=(#BackgroundHeight#-2)
SolidColor=#HDOverlay#
Group=RefreshOverlay
MouseActionCursor=0
UpdateDivider=-1
Hidden=1

[PreButtonText1]
; Shows 1st line of text before button.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=56
Group=RefreshOverlay
Text="Connection Error"
UpdateDivider=-1
Hidden=1

[PreButtonText2]
; Shows 2nd line of text before button.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=0R
Text="Try again in a couple seconds."
Group=RefreshOverlay
UpdateDivider=-1
Hidden=1

[RefreshButtonEdge]
; Shows 1px edge of refresh button; hidden when button is pressed.
Meter=Image
X=([RefreshButton:X]-1)
Y=([RefreshButton:Y]-1)
W=148
H=32
SolidColor=#WindowsColor#
Group=RefreshOverlay | WindowsColorGroup
UpdateDivider=-1
DynamicVariables=1
Hidden=1

[RefreshButton]
; Shows refresh button; controls mouse behavior when interacting with button.
Meter=Image
X=((#BackgroundWidth#/2)-((148-2)/2))
Y=([PreButtonText1:Y]+60)
;W=([RefreshButtonEdge:W]-2)
;H=([RefreshButtonEdge:H]-2)
W=(148-2)
H=(32-2)
SolidColor=#WindowsColor#
Group=RefreshOverlay | WindowsColorGroup
LeftMouseDownAction=[!HideMeter RefreshButtonEdge][!HideMeter RefreshButtonCenter]
LeftMouseUpAction=[!Refresh]
MouseOverAction=[!ShowMeter RefreshButtonHoverEdge]
MouseLeaveAction=[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]
;[!SetOption RefreshButton MouseLeaveAction "[!HideMeter RefreshButtonHoverEdge][!ShowMeter RefreshButtonEdge][!ShowMeter RefreshButtonCenter]"]
;[!SetOption RefreshButton MouseLeaveAction "[]"]
MouseActionCursor=0
UpdateDivider=-1
DynamicVariables=1
Hidden=1

[RefreshButtonHoverEdge]
; Shows transparent white edge when mouse is hovering over button. Also acts as white overlay when button is pressed.
Meter=Image
X=([RefreshButton:X]-1)
Y=([RefreshButton:Y]-1)
W=148
H=32
SolidColor=#TransparentWhite2#
Group=RefreshOverlay
UpdateDivider=-1
Hidden=1

[RefreshButtonCenter]
; Shows smaller version of refresh button; shown when button is not pressed.
Meter=Image
X=([RefreshButton:X]+1)
Y=([RefreshButton:Y]+1)
W=(148-4)
H=(32-4)
SolidColor=#WindowsColor#
Group=RefreshOverlay | WindowsColorGroup
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[RefreshButtonText]
; Shows text on refresh button (i.e. "Refresh").
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=([RefreshButton:Y]+5)
Group=RefreshOverlay
Text="Refresh"
FontFace=Segoe UI Semibold
UpdateDivider=-1
Hidden=1


; ------------------------------------------------------------------------
; METERS - Location overlay
; ------------------------------------------------------------------------

[LocationBackground]
; Shows background of overlay.
Meter=Image
X=1
Y=1
W=(#BackgroundWidth#-2)
H=(#BackgroundHeight#-2)
SolidColor=#HDOverlay#
Group=LocationOverlay
LeftMouseUpAction=[!HideMeterGroup LocationOverlay][!HideMeter CheckingLocationText][!HideMeter ErrorText]
MouseActionCursor=0
UpdateDivider=-1
Hidden=1

[PreInputText1]
; Shows 1st line of text before input box.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=37
Group=LocationOverlay
Text="Enter location using "Zip code,""
UpdateDivider=-1
Hidden=1

[PreInputText2]
; Shows 2nd line of text before input box.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=0R
Group=LocationOverlay
Text=""City, State," or "City, Country" formatting."
UpdateDivider=-1
Hidden=1

[LocationInputOverlayBorder]
; Shows border of non-active input box; changes color based on mouse position.
Meter=Image
X=((#BackgroundWidth#/2)-(271/2))
Y=([PreInputText1:Y]+60)
W=271
H=32
SolidColor=#SolidGreyPause#
Group=LocationOverlay
LeftMouseUpAction=[!CommandMeasure MeasureLocationInput "ExecuteBatch All"][!ShowMeter LocationInputBorder][!UpdateMeter LocationInputBorder]
MouseOverAction=[!SetOption LocationInputOverlayBorder SolidColor #SolidOffWhite#][!UpdateMeter LocationInputOverlayBorder]
MouseLeaveAction=[!SetOption LocationInputOverlayBorder SolidColor #SolidGreyPause#][!UpdateMeter LocationInputOverlayBorder]
MouseActionCursorName=Text
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[CheckingLocationText]
; Shows text while confirming location.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign | StyleWindowsColorText
X=(#BackgroundWidth#/2)
Y=7R
Text="Searching for location..."
FontSize=10
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[ErrorText]
; Shows text if there is a connection error when confirming location.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign | StyleErrorText
X=(#BackgroundWidth#/2)
Y=0R
Text="Error: Location not found. Please try again."
FontSize=10
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[PostInputText]
; Shows text instructions after input box.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText | StyleCenterAlign
X=(#BackgroundWidth#/2)
Y=158
Group=LocationOverlay
Text="(Click outside text box to cancel; press "Enter" to confirm.)"
FontSize=8
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[LocationInputBorder]
; Shows border of active input box.
Meter=Image
X=[LocationInputOverlayBorder:X]
Y=[LocationInputOverlayBorder:Y]
W=271
H=32
SolidColor=#WindowsColor#
Group=LocationOverlay |  WindowsColorGroup
MouseActionCursorName=Text
DynamicVariables=1
UpdateDivider=-1
Hidden=1

[LocationInputOverlay]
; Shows non-active input box; initiates input process when clicked and controls border color based on mouse position.
Meter=String
MeterStyle=StyleSmallText | StyleWhiteText
X=2r
Y=2r
W=(271-4)
H=(32-4)
SolidColor=#WindowsColorDark#
Group=LocationOverlay | WindowsDarkColorGroup
Text=#Location#
LeftMouseUpAction=[!CommandMeasure MeasureLocationInput "ExecuteBatch All"][!ShowMeter LocationInputBorder][!UpdateMeter LocationInputBorder]
MouseOverAction=[!SetOption LocationInputOverlayBorder SolidColor #SolidOffWhite#][!UpdateMeter LocationInputOverlayBorder]
MouseLeaveAction=[!SetOption LocationInputOverlayBorder SolidColor #SolidGreyPause#][!UpdateMeter LocationInputOverlayBorder]
MouseActionCursorName=Text
DynamicVariables=1
UpdateDivider=-1
Hidden=1
